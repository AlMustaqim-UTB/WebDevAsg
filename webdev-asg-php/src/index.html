<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room Booking - Test</title>
</head>
<body>
    <h1>Car Rental Test</h1>
    <button id="load">Load data</button> 
    <pre id="out"></pre>

    <h2>AddUser</h2>
    <div>
        <input id="customerID" type="text" placeholder="customerID" />
        <input id="licenseNo" type="text" placeholder="licenseNo" />
        <input id="email" type="text" placeholder="email" />
        <input id="password" type="password" placeholder="password" />
        <button id="addUser">Add User</button>
    </div>

    <h2>VerifyPass</h2>
    <div>
        <input id="verifyCustomerID" type="text" placeholder="customerID" />
        <input id="verifyPassword" type="password" placeholder="password" />
        <button id="verify">Verify</button>
    </div>

    <script>
        const out = document.getElementById('out');
        const apiBaseUrl = 'http://localhost:8080/api/indexDB.php';
        // const apiBaseUrl = 'http://localhost/webdev-asg-php/src/api/indexDB.php';

        // Generic fetch handler to reduce repetition
        async function handleFetch(url, options = {}) {
            out.textContent = 'Loading...';
            try {
                const res = await fetch(url, options);
                const text = await res.text();
                if (!res.ok) throw new Error(text || res.statusText);
                const json = text ? JSON.parse(text) : { success: true, message: 'OK' };
                out.textContent = JSON.stringify(json, null, 2);
            } catch (err) {
                out.textContent = 'Error: ' + err.message;
            }
        }

        //load data function basix
        document.getElementById('load').addEventListener('click', () => {
            handleFetch(`${apiBaseUrl}?action=list`);
        });

        //add user function
        document.getElementById('addUser').addEventListener('click', () => {
            const payload = {
                customerID: document.getElementById('customerID').value,
                licenseNo: document.getElementById('licenseNo').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value
            };
            handleFetch(`${apiBaseUrl}?action=add`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
        });

        //verify custID and pass funct
        document.getElementById('verify').addEventListener('click', () => {
            const payload = {
                customerID: document.getElementById('verifyCustomerID').value,
                password: document.getElementById('verifyPassword').value
            };
            handleFetch(`${apiBaseUrl}?action=verify`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
        });
    </script>
</body>
</html>