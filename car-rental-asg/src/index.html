<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Room Booking - Test</title>
</head>
<body>
    <h2>Add 2 customer table</h2>
    <div>
        <input id="customerID" type="text" placeholder="customerID" />
        <input id="licenseNo" type="text" placeholder="licenseNo" />
        <input id="email" type="text" placeholder="email" />
        <input id="password" type="password" placeholder="password" />
        <button id="addCustomer">Add User</button>
    </div>

    <h2>Add 2 admin table</h2>
    <div>
        <input id="adminID" type="text" placeholder="adminID" />
        <input id="adminEmail" type="text" placeholder="adminEmail" />
        <input id="adminPassword" type="password" placeholder="adminPassword" />
        <button id="addAdmin">Add User</button>
    </div>

    <h2>Verify Password (Customer & Admin)</h2>
    <div>
        <input id="verifyEmail" type="text" placeholder="email" />
        <input id="verifyPassword" type="password" placeholder="password" />
        <button id="verify">Verify</button>
    </div>
    <pre id="out"></pre>
    <script>
        const out = document.getElementById('out');
        const apiBaseUrl = 'http://localhost:8080/api/indexDB.php';
        // const apiBaseUrl = 'http://localhost/webdev-asg-php/src/api/indexDB.php';
        const customerFields = document.getElementById('customerFields');
        const roleCustomerRadio = document.getElementById('roleCustomer');
        const roleAdminRadio = document.getElementById('roleAdmin');
        

        // Generic fetch handler to reduce repetition
        async function handleFetch(url, options = {}) {
            out.textContent = 'Loading...';
            try {
                const res = await fetch(url, options);
                const text = await res.text();
                if (!res.ok) throw new Error(text || res.statusText);
                const json = text ? JSON.parse(text) : { success: true, message: 'OK' };
                out.textContent = JSON.stringify(json, null, 2);
            } catch (err) {
                out.textContent = 'Error: ' + err.message;
            }
        }

        //add customer function
        document.getElementById('addCustomer').addEventListener('click', () => {
            const payload = {
                customerID: document.getElementById('customerID').value,
                licenseNo: document.getElementById('licenseNo').value,
                email: document.getElementById('email').value,
                password: document.getElementById('password').value
            };
            handleFetch(`${apiBaseUrl}?action=add`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
        });

        //verify email and password for both customer and admin
        document.getElementById('verify').addEventListener('click', () => {
            const payload = {
                email: document.getElementById('verifyEmail').value,
                password: document.getElementById('verifyPassword').value
            };
            handleFetch(`${apiBaseUrl}?action=verify`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(payload)
            });
        });
    </script>
</body>
</html>